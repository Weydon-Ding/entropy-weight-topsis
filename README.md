# 熵权TOPSIS模型实现

本仓库提供了基于熵权TOPSIS（Technique for Order Preference by Similarity to Ideal Solution）方法的多指标综合评价模型实现，用于对多维度数据进行客观评分与排序。

## 模型简介

熵权TOPSIS是一种结合熵权法和TOPSIS法的综合评价方法：
- **熵权法**：通过数据本身的信息熵计算指标权重，避免主观赋权的偏差
- **TOPSIS法**：通过计算各方案与理想解的贴近度进行排序，适用于多指标决策分析

## 环境依赖

- Python 3.x
- 第三方库：
  - numpy
  - pandas
  - openpyxl

安装依赖：
```bash
pip install -r requirements.txt
```

## 使用方法

1. **准备数据**：在`entropy_weight_topsis.py`中修改`data`变量，按指标行、年份列的格式填写数据（默认使用制表符分隔）
2. **设置指标类型**：通过`types`列表定义指标类型（1表示效益型指标，数值越大越好；0表示成本型指标，数值越小越好）
3. **调整分组方式**：默认按3个指标一组进行分组分析，可根据需求修改分组逻辑（支持不规律分组）
4. **运行程序**：
   ```bash
   python entropy_weight_topsis.py
   ```
5. **查看结果**：程序会生成`topsis_results_all.xlsx`文件，包含各项计算结果

## 输出结果说明

Excel文件中包含以下内容：
- 全部指标的整体分析结果
- 分组指标的单独分析结果（按设定的分组方式）

每项结果包含：
- 标准化矩阵：数据标准化处理后的结果
- 指标比重：各指标在不同年份的占比
- 熵值：各指标的信息熵
- 差异化系数：1-熵值，反映指标的区分能力
- 熵权：基于熵值计算的指标权重
- 正/负理想解：最优/最劣方案的参考值
- 距离：各方案与理想解的欧氏距离
- 相对贴近度：综合评价指数
- 排名：基于综合评价指数的排序结果

## 自定义配置

### 调整分组方式
如需修改分组逻辑（如不规律分组），可修改代码中的分组定义部分：
```python
# 示例：不规律分组
groups = [
    (0, 1),   # 第一组：指标1-2（索引0和1）
    (2, 6),   # 第二组：指标3-7（索引2到6）
    (7, 14)   # 第三组：指标8-15（索引7到14）
]
```

### 数据格式调整
若数据使用空格分隔而非制表符，可修改数据解析部分：
```python
X = np.array([[float(val.replace(',', '')) for val in line.split()] for line in lines]).T
```

## 注意事项

- 确保`types`列表长度与指标数量一致
- 数据中若包含逗号分隔符（如千位分隔符），程序会自动处理
- 分组时请确保索引范围正确，避免越界错误
- 若指标数据全部相同，可能导致标准化时除数为0，建议提前处理异常数据

## 许可证

本项目采用MIT许可证，详情参见LICENSE文件。